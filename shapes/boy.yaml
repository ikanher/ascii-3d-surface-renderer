# Boy's Surface
vars: [u, θ]
domain:
  u: [0.0, 1.0]
  θ: [0.0, 6.283185307179586]   # 2π
normal_sign: -1
equations: |
  # denominator (real part of w^6 + √5·w^3 − 1)
  den_raw = u**6*cos(6*θ) + 5**0.5*u**3*cos(3*θ) - 1

  # NB: can't use `abs` here, hence sqrt(x^2)
  den     = sqrt(den_raw**2 + 1e-12)  # always positive, smoothly differentiable

  # g1 = -1.5·Im[w·(1−w^4)]/den = -1.5·(u·sinθ - u^5·sin5θ)/den
  g1   = -1.5*(u*sin(θ) - u**5*sin(5*θ)) / den

  # g2 = -1.5·Re[w·(1+w^4)]/den = -1.5·(u·cosθ + u^5·cos5θ)/den
  g2   = -1.5*(u*cos(θ) + u**5*cos(5*θ)) / den

  # g3 = Im[1 + w^6]/den − 0.5 = (u^6·sin6θ)/den − 0.5
  g3   = u**6*sin(6*θ) / den - 0.5

  # normalize
  norm = (g1**2 + g2**2 + g3**2)**0.5

  # final xyz
  x = g1 / norm
  y = g2 / norm
  z = g3 / norm
